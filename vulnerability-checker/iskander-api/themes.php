<?php

require_once("api.php");

$wpvuln = new WP_Vuln();
$res = $wpvuln->check_themes_batch($input);

// switch(getallheaders()["Response-Type"]) {
switch($_SERVER["HTTP_RESPONSE_TYPE"]) {
	case "table":
		//echo "Formatting as table";
		echo $wpvuln->format_data_table($res);
		break;
	case "json":
		//echo "Formatting as json";
		echo json_encode($res);
		break;
	case "bool":
		// Process the first element only
		if(array_shift($res)) {
			echo 1;
		} else {
			echo 0;
		}
		break;
	default:
		//echo "Formatting as default";
		echo json_encode($res);
		break;
}
